# アプリケーション テストガイド

このドキュメントは、本アプリケーションをローカル環境で起動し、基本的な機能をテストするための手順を説明します。

## 1. 前提条件

テストを開始する前に、以下の環境が設定されていることを確認してください。

- **Python 3.8以上**
- **pip** (Pythonのパッケージ管理ツール)
- **Google Gemini APIキー**

## 2. セットアップ手順

### ステップ1: .envファイルの作成

プロジェクトのルートディレクトリに `.env` という名前のファイルを作成し、以下の内容を記述します。`YOUR_API_KEY`の部分は、ご自身のGoogle Gemini APIキーに置き換えてください。

```
GEMINI_API_KEY=YOUR_API_KEY
```

### ステップ2: 依存関係のインストール

ターミナルを開き、プロジェクトのルートディレクトリで以下のコマンドを実行して、必要なPythonパッケージをインストールします。

```bash
pip install -r requirements.txt
```

## 3. エディタの初期化テスト

### 3.1 依存関係のチェック

1. ブラウザで開発者ツールを開く（F12）
2. コンソールタブを選択
3. 以下のメッセージが表示されていることを確認
   - `editor.js が読み込まれました`
   - `markdown-converter.js が読み込まれました`
   - `markdownToHtml 関数が定義されました`
   - エラーメッセージが表示されていないこと

### 3.2 エディタの初期化確認

1. エディタページを開く
2. 以下の要素が正しく表示されていることを確認
   - ツールバー
   - 編集エリア
   - プレビューエリア（エディタの右側）
3. コンソールにエラーメッセージが表示されていないことを確認

### 3.3 初期コンテンツの読み込みテスト

1. 初期コンテンツを含むHTMLを用意
   ```html
   <div id="initial-content" style="display: none;">
     # テストタイトル
     これはテスト用の初期コンテンツです。
   </div>
   ```
2. ページを再読み込みし、初期コンテンツが正しく読み込まれることを確認
3. プレビューに初期コンテンツが反映されていることを確認

## 4. エラーハンドリングテスト

### 4.1 依存関係が不足している場合

1. 開発者ツールのコンソールで以下のコマンドを実行
   ```javascript
   window.Quill = undefined;
   window.markdownToHtml = undefined;
   ```
2. ページをリロード
3. 適切なエラーメッセージが表示されることを確認

### 4.2 初期化エラーの場合

1. 開発者ツールのコンソールで以下のコマンドを実行
   ```javascript
   document.getElementById('editor-container').remove();
   ```
2. ページをリロード
3. 適切なエラーメッセージが表示されることを確認

## 5. アプリケーションの起動

依存関係のインストールが完了したら、以下のコマンドを実行してWebサーバーを起動します。

```bash
uvicorn main:app --reload
```

`--reload`オプションにより、コードを変更するとサーバーが自動的に再起動します。

サーバーが正常に起動すると、以下のようなメッセージがターミナルに表示されます。

```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [xxxxx]
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

## 4. ブラウザでの機能テスト

### ステップ1: アプリケーションへのアクセス

Webブラウザを開き、アドレスバーに以下のURLを入力します。

[http://127.0.0.1:8000](http://127.0.0.1:8000)

### ステップ2: シナリオ生成機能のテスト

1.  **UIの確認**: 画面に「テーマ」と「キーワード」の入力フィールド、そして「シナリオを生成」ボタンが表示されていることを確認します。
2.  **入力**: 「テーマ」に任意のテーマ（例: `探偵`）、 「キーワード」にいくつかのキーワード（例: `古い屋敷, 謎の手紙, 失踪した貴族`）を入力します。
3.  **生成**: 「シナリオを生成」ボタンをクリックします。
4.  **結果の確認**: 
    - 処理中のローディング表示が出た後、「（ゲームタイトル）が生成されました！」という成功メッセージが表示されることを確認します。
    - ページ下部の「生成されたゲーム一覧」に、新しく作成されたゲームがカードとして追加されることを確認します。

### ステップ3: （今後のテスト項目）

- 生成されたゲームカードをクリックすると、シナリオ編集画面に遷移すること。
- シナリオ編集画面で内容を編集し、保存できること。
- テストプレイ画面でゲームをプレイできること。

以上で、現在実装されている主要機能のテストは完了です。
