# 仕様書

## 1. 概要

本プロジェクトは、AIを活用してアドベンチャーゲームのシナリオライターの創作活動を支援するためのWebアプリケーションです。

ライターは、テーマやキーワードを入力することで、AIにシナリオの草案を生成させることができます。生成されたシナリオは、Web上のエディタで自由に編集・管理でき、すぐにテストプレイで動作を確認することが可能です。

## 2. 目的

- AIによるアイデア出しとシナリオの骨子作成により、ライターの創作における初期段階の負担を軽減する。
- シナリオのデータ構造をJSONで統一し、編集・管理・拡張を容易にする。
- 作成したシナリオを即座にテストプレイできる環境を提供し、トライ＆エラーのサイクルを高速化する。

## 3. 主要機能

- **AIによるシナリオ草案生成機能**
  - テーマとキーワードに基づき、AI (Google Gemini) がJSON形式のシナリオ草案を生成します。
- **シナリオエディタ機能**
  - 生成または作成されたシナリオ（JSON）をWeb UI上で直感的に編集できます。
  - タイトル、説明、登場人物、フラグ、アイテム、各ステップのテキストや選択肢などを編集可能です。
- **テストプレイ機能**
  - 編集中のシナリオを、実際のゲーム画面で即座にテストプレイできます。
- **シナリオ管理機能**
  - 作成したシナリオの一覧表示、検索、絞り込みができます。

## 4. アーキテクチャ

- **フロントエンド**: HTML, CSS, JavaScript
  - ユーザーインターフェースを提供します。
- **バックエンド**: Python (FastAPI)
  - APIを提供し、フロントエンドからのリクエストを処理します。
- **AIモデル**: Google Gemini 1.5 Flash
  - プロンプトに基づいてシナリオを生成します。
- **データストレージ**: JSONファイル
  - 生成・編集されたシナリオデータは、サーバーの `games/` ディレクトリにJSONファイルとして保存されます。

## 5. API仕様

### `POST /api/generate`

- **説明**: AIにシナリオの草案を生成させます。
- **リクエストボディ**:
  ```json
  {
    "theme": "string",
    "keywords": "string"
  }
  ```
- **レスポンス**: 生成されたシナリオのJSONデータ

### `GET /api/stories`

- **説明**: 保存されているシナリオの一覧を取得します。
- **レスポンス**: シナリオのメタデータ（ID, タイトル, 説明など）の配列

### `GET /api/scenario/{game_id}`

- **説明**: 指定した `game_id` のシナリオデータを取得します。
- **レスポンス**: シナリオの完全なJSONデータ

### `POST /api/update_scenario`

- **説明**: 既存のシナリオを更新します。
- **リクエストボディ**: シナリオの完全なJSONデータ
- **レスポンス**: 成功メッセージ
